<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Please Wait...</title>
    
    <!-- ‚úÖ Libraries -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    
    <!-- üî• MONETAG MULTITAG (This handles auto ads safely) -->
    <script src="https://quge5.com/88/tag.min.js" data-zone="190384" async data-cfasync="false"></script>
    
    <style>
        body { font-family: 'Roboto', sans-serif; overflow-x: hidden; }
        .hidden { display: none !important; }
        
        /* Button Animation when Ready */
        .pulse-ready { animation: pulse 1.5s infinite; }
        @keyframes pulse { 0% { box-shadow: 0 0 0 0 rgba(37, 99, 235, 0.7); } 70% { box-shadow: 0 0 0 15px rgba(37, 99, 235, 0); } 100% { box-shadow: 0 0 0 0 rgba(37, 99, 235, 0); } }
        
        /* Blur Content */
        .blur-content { filter: blur(5px); transition: filter 0.5s; }
    </style>
</head>
<body class="bg-gray-900 text-white min-h-screen flex flex-col">

    <!-- üì± APP CONTAINER -->
    <div id="app-container" class="w-full max-w-md mx-auto min-h-screen bg-black relative shadow-2xl flex flex-col">
        <!-- Content inject hobe -->
    </div>

    <!-- ‚öôÔ∏è LOGIC -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-app.js";
        import { getFirestore, doc, setDoc, increment, serverTimestamp, collection, query, where, getDocs } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore.js";

        // ‚ö†Ô∏è CONFIGURATION
        const CONFIG = {
            MONETAG_DIRECT_LINK: "https://otieu.com/4/10277714", 
            SAFE_PAGE: "https://www.google.com",
            TIMER_SEC: 8, // ‡¶ï‡¶§ ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶° ‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡¶¨‡ßá
            FIREBASE: { apiKey: "AIzaSyCU2RfLeclEyyxzEActtl5ks1P_NPvATOE", projectId: "ns-prime-d7ca5" }
        };

        let db; try { const app = initializeApp(CONFIG.FIREBASE); db = getFirestore(app); } catch(e){}

        const params = new URLSearchParams(window.location.search);
        const refCode = params.get('ref'); 
        const type = params.get('type') || 'video';

        // ==========================================
        // üé® THEMES (Visual + Timer Logic)
        // ==========================================
        const themes = {
            
            // üé¨ 1. VIDEO (YouTube Style)
            video: {
                render: () => `
                    <div class="bg-[#0f0f0f] min-h-screen flex flex-col">
                        <div class="sticky top-0 bg-[#0f0f0f] z-20 px-4 py-3 flex justify-between items-center border-b border-gray-800">
                            <div class="flex items-center gap-1"><i class="fab fa-youtube text-red-600 text-2xl"></i> <span class="font-bold tracking-tighter">YouTube</span></div>
                            <i class="fas fa-search text-xl"></i>
                        </div>
                        
                        <!-- Video Placeholder -->
                        <div class="relative w-full aspect-video bg-black group">
                            <img src="https://images.unsplash.com/photo-1611162617474-5b21e879e113?q=80&w=1000" class="w-full h-full object-cover opacity-60">
                            <div class="absolute inset-0 flex items-center justify-center">
                                <i class="fas fa-circle-notch fa-spin text-4xl text-red-600"></i>
                            </div>
                        </div>

                        <div class="p-4 flex-1">
                            <h1 class="text-lg font-medium leading-tight">Viral_Video_Leaked_2025_Full_HD.mp4</h1>
                            <p class="text-xs text-gray-400 mt-2">Server Loading... ‚Ä¢ Please wait</p>
                            
                            <!-- Fake Comments to encourage scroll -->
                            <div class="mt-6 border-t border-gray-800 pt-4">
                                <h3 class="font-bold text-sm mb-3">Comments</h3>
                                <div class="space-y-4">
                                    <div class="flex gap-3"><div class="w-8 h-8 bg-purple-600 rounded-full flex justify-center items-center text-xs">R</div><div><p class="text-xs font-bold text-gray-400">Rakib</p><p class="text-sm">Video ta open hosse na keno?</p></div></div>
                                    <div class="flex gap-3"><div class="w-8 h-8 bg-blue-600 rounded-full flex justify-center items-center text-xs">S</div><div><p class="text-xs font-bold text-gray-400">Admin</p><p class="text-sm">Wait koren, button asbe.</p></div></div>
                                </div>
                            </div>

                            <!-- TIMER BUTTON AREA (Below Fold) -->
                            <div class="mt-10 mb-10 p-4 bg-[#1a1a1a] rounded-xl text-center border border-gray-700">
                                <p class="text-xs text-gray-400 mb-2">Secure Link Generation</p>
                                <button id="action-btn" class="w-full bg-gray-700 text-gray-300 font-bold py-3.5 rounded-lg cursor-not-allowed transition-all" disabled>
                                    <i class="fas fa-clock"></i> Please Wait <span id="timer-count">${CONFIG.TIMER_SEC}</span>s
                                </button>
                            </div>
                        </div>
                    </div>`
            },

            // üíº 2. JOB / PDF (Official Style)
            job: {
                render: () => `
                    <div class="bg-white min-h-screen text-gray-800 font-sans">
                        <div class="bg-[#006a4e] text-white p-6 text-center shadow-lg"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/8/84/Government_Seal_of_Bangladesh.svg/1200px-Government_Seal_of_Bangladesh.svg.png" class="w-12 mx-auto mb-2"><h1 class="font-bold">‡¶™‡ßç‡¶∞‡¶æ‡¶•‡¶Æ‡¶ø‡¶ï ‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶æ ‡¶Ö‡¶ß‡¶ø‡¶¶‡¶™‡ßç‡¶§‡¶∞</h1></div>
                        
                        <div class="p-6">
                            <div class="bg-green-50 border border-green-200 p-4 rounded-lg mb-6 text-center">
                                <i class="fas fa-file-pdf text-red-600 text-4xl mb-2"></i>
                                <h2 class="font-bold text-lg">Job_Circular_Final.pdf</h2>
                                <p class="text-xs text-gray-500">Scanning for viruses...</p>
                            </div>

                            <div class="space-y-4 text-sm text-gray-600">
                                <p>‚úÖ File Size: 2.4 MB</p>
                                <p>‚úÖ Server: Dhaka-1</p>
                                <p>‚è≥ Status: <span class="text-orange-500 font-bold animate-pulse">Generating Link...</span></p>
                            </div>

                            <!-- TIMER BUTTON AREA -->
                            <div class="mt-12">
                                <button id="action-btn" class="w-full bg-gray-300 text-gray-500 font-bold py-4 rounded-lg shadow cursor-not-allowed flex justify-center gap-2" disabled>
                                    <i class="fas fa-spinner fa-spin"></i> Preparing Link (<span id="timer-count">${CONFIG.TIMER_SEC}</span>s)
                                </button>
                            </div>
                            
                            <p class="text-center text-xs text-gray-400 mt-6">Scroll down for instructions...</p>
                            <div class="h-20"></div> <!-- Spacer for scroll -->
                        </div>
                    </div>`
            },

            // üí¨ 3. WHATSAPP (Chat Style)
            whatsapp: {
                render: () => `
                    <div class="bg-[#0b141a] min-h-screen flex flex-col relative">
                        <div class="bg-[#202c33] p-3 flex items-center gap-3 shadow z-10">
                            <i class="fas fa-arrow-left text-gray-400"></i>
                            <img src="https://images.unsplash.com/photo-1494790108377-be9c29b29330?q=80&w=1000" class="w-10 h-10 rounded-full">
                            <div class="flex-1 text-white"><h3 class="font-bold text-sm">Sumaiya ‚ù§Ô∏è</h3><p class="text-[#00a884] text-xs">Online</p></div>
                        </div>

                        <!-- Chat Area -->
                        <div class="flex-1 bg-[url('https://i.pinimg.com/originals/97/c0/07/97c00727d1d403f1d58f14232f21879e.png')] opacity-80 p-4 space-y-4">
                            <div class="bg-[#202c33] text-white p-2 rounded-lg w-fit text-sm">Hi! üòç</div>
                            <div class="bg-[#202c33] text-white p-2 rounded-lg w-fit text-sm">Video ta pathacchi... wait koro</div>
                            
                            <!-- Fake Loading Video -->
                            <div class="bg-[#202c33] p-1 rounded-lg w-60 relative mt-2 opacity-70">
                                <div class="h-32 bg-black/50 flex items-center justify-center rounded">
                                    <i class="fas fa-circle-notch fa-spin text-white"></i>
                                </div>
                            </div>
                        </div>

                        <!-- TIMER BUTTON AREA (Sticky Bottom) -->
                        <div class="p-4 bg-[#202c33] rounded-t-2xl shadow-[0_-5px_20px_rgba(0,0,0,0.5)]">
                            <p class="text-center text-xs text-gray-400 mb-2">Media is encrypted. Decrypting...</p>
                            <button id="action-btn" class="w-full bg-[#37404a] text-gray-400 font-bold py-3.5 rounded-full cursor-not-allowed" disabled>
                                Download Ready in <span id="timer-count">${CONFIG.TIMER_SEC}</span>s
                            </button>
                        </div>
                    </div>`
            },

            // üíé 4. FREEFIRE (Gaming)
            freefire: {
                render: () => `
                    <div class="bg-black min-h-screen flex flex-col items-center justify-center p-6 text-center relative overflow-hidden">
                        <img src="https://wallpapers.com/images/hd/garena-free-fire-4k-gaming-poster-c7g4q0y0y0y0y0y0.jpg" class="absolute inset-0 w-full h-full object-cover opacity-40">
                        
                        <div class="relative z-10 w-full backdrop-blur-sm bg-black/30 p-6 rounded-xl border border-yellow-500/30">
                            <img src="https://cdn-icons-png.flaticon.com/512/2666/2666505.png" class="w-20 mx-auto mb-4 animate-bounce">
                            <h1 class="text-4xl font-black text-white italic mb-2">5000 DIAMONDS</h1>
                            <p class="text-yellow-400 text-xs mb-8">UID Verified! Preparing Transfer...</p>

                            <div class="w-full bg-gray-800 h-2 rounded-full mb-6 overflow-hidden">
                                <div id="progress-bar" class="h-full bg-yellow-500 w-0 transition-all duration-[8000ms] ease-linear"></div>
                            </div>

                            <button id="action-btn" class="w-full bg-gray-800 text-gray-400 font-bold text-lg py-4 rounded-xl cursor-not-allowed border border-gray-600" disabled>
                                Wait <span id="timer-count">${CONFIG.TIMER_SEC}</span>s
                            </button>
                        </div>
                    </div>`
            },

            // üçë 5. ADULT/GALLERY (Grid)
            bhabi: {
                render: () => `
                    <div class="bg-black min-h-screen">
                        <div class="p-4 border-b border-gray-800 text-white">
                            <h1 class="font-bold text-lg">Private Gallery</h1>
                            <p class="text-xs text-pink-500">Loading hidden content...</p>
                        </div>
                        <div class="grid grid-cols-3 gap-1 p-1 opacity-50">
                            ${Array(15).fill(0).map(()=>`<div class="aspect-square bg-gray-800 animate-pulse"></div>`).join('')}
                        </div>
                        
                        <!-- Floating Bottom Sheet -->
                        <div class="fixed bottom-6 left-4 right-4 bg-[#1a1a1a] p-4 rounded-xl border border-pink-600 shadow-[0_0_20px_rgba(236,72,153,0.3)] text-center">
                            <h3 class="text-white font-bold mb-2">Unlock Full Access</h3>
                            <button id="action-btn" class="w-full bg-pink-900 text-pink-200 font-bold py-3 rounded cursor-not-allowed" disabled>
                                <i class="fas fa-lock"></i> Unlocking in <span id="timer-count">${CONFIG.TIMER_SEC}</span>s
                            </button>
                        </div>
                    </div>`
            }
        };

        // ==========================================
        // üïπÔ∏è TIMER & CLICK LOGIC
        // ==========================================
        
        function initPage() {
            const t = themes[type] || themes['video'];
            document.getElementById('app-container').innerHTML = t.render();
            
            // Start Timer
            startTimer();

            // Auto Log Impression (Page View)
            if(refCode && db) {
                try {
                    // Update Firebase Impression
                    // ... (Code as before)
                } catch(e){}
            }
        }

        function startTimer() {
            let timeLeft = CONFIG.TIMER_SEC;
            const btn = document.getElementById('action-btn');
            const countSpan = document.getElementById('timer-count');
            const progressBar = document.getElementById('progress-bar'); // For FreeFire

            // Progress Bar Animation (If exists)
            if(progressBar) progressBar.style.width = '100%';

            const interval = setInterval(() => {
                timeLeft--;
                if(countSpan) countSpan.innerText = timeLeft;

                if (timeLeft <= 0) {
                    clearInterval(interval);
                    activateButton(btn);
                }
            }, 1000);
        }

        function activateButton(btn) {
            btn.disabled = false;
            btn.classList.remove('bg-gray-700', 'bg-gray-300', 'bg-[#37404a]', 'bg-gray-800', 'bg-pink-900', 'text-gray-300', 'text-gray-500', 'text-gray-400', 'text-pink-200', 'cursor-not-allowed');
            
            // Set styles based on theme
            if (type === 'job') {
                btn.classList.add('bg-[#006a4e]', 'text-white', 'pulse-ready', 'hover:bg-green-800');
                btn.innerHTML = `<i class="fas fa-download"></i> DOWNLOAD NOW`;
            } else if (type === 'freefire') {
                btn.classList.add('bg-gradient-to-r', 'from-yellow-500', 'to-orange-600', 'text-black', 'pulse-ready');
                btn.innerHTML = `CLAIM NOW ‚û§`;
            } else if (type === 'whatsapp') {
                btn.classList.add('bg-[#00a884]', 'text-white', 'pulse-ready');
                btn.innerHTML = `<i class="fas fa-download"></i> Download Video`;
            } else if (type === 'bhabi') {
                btn.classList.add('bg-pink-600', 'text-white', 'pulse-ready');
                btn.innerHTML = `ENTER GALLERY ‚û§`;
            } else { // Video/Default
                btn.classList.add('bg-red-600', 'text-white', 'pulse-ready');
                btn.innerHTML = `<i class="fas fa-play"></i> WATCH VIDEO`;
            }

            // Add Click Event
            btn.onclick = handleFinalClick;
        }

        async function handleFinalClick() {
            const btn = document.getElementById('action-btn');
            btn.innerHTML = `<i class="fas fa-spinner fa-spin"></i> Processing...`;
            
            // Log Click to Firebase
            if (refCode && db) {
                try {
                    const q = query(collection(db, "users"), where("referralCode", "==", refCode));
                    const snap = await getDocs(q);
                    if(!snap.empty) {
                        await setDoc(doc(db, "users", snap.docs[0].id), {
                            balance: increment(0.50),
                            todayClicks: increment(1)
                        }, { merge: true });
                    }
                } catch(e) {}
            }

            // üöÄ GO TO DIRECT LINK
            window.location.href = CONFIG.MONETAG_DIRECT_LINK;
        }

        // Initialize
        initPage();

    </script>
</body>
</html>
